# multiCAFE
Icy plugin to analyze multiCAFE observations (feeding of drosophila flies from capillaries)

This plugin is meant to allow users to analyze stack of frames collected during CAFE/multiCAFE experiments. CAFE/multiCAFE are acronyms for (multiple) CApillary Feeding Experiments where we measure how much flies (insects, drosophila) feed from capillary tubes containing a liquid (generally sweet water added with a blue dye and another substance to test). 
This has a number of scientific uses, e.g. to study feeding in flies and to find molecules with prevent or stimulate feeding, or to understand the impact of diseases or other factors on feeding. In our current design, one webcam is monitoring 10 "cages", each containing 1 fly. Each cage can be equipped with 2 capillaries. We want to follow throughout time how flies are feeding - generally by snapping 1980x 1080 jpg image every minute over interval of times ranging from 1 h to several days, eventually renewing the capillaries when they are empty.
At the basic level, multiCAFE is meant to read and analyze 1 pile of images (= 1 experiment). The user defines the position of capillaries using linear ROIs (typically 20 capillaries for 10 cages). The program then create an array of kymographs to follow the evolution of the pixels described by the ROIs, ie to follow the consumption in each capillary. The top and bottom level of each capillary can be detected and the measures saved and exported to Excel.
We can also follow the position of each fly in their cages across time with another set of routines. This is done best by defining a reference image frame made by using the first frame of the stack and removing the flies after they have moved from their initial position. Then this reference image is subtracted to each image of the stack so that flies appear as white objects on a black background. The xyt position of each fly is then stored and exported to Excel. These data are used mainly to monitor if flies are alive and when they stop being active.
Lastly, data collected over several experiments can be collected and the whole series of observations can be exported to an Excel file storing the raw data of different parameters measured from the capillaries or from the flies, in order to be used within pivot tables that allow users to analyze and visualize their data interactively according to several descriptors associated to the data during the analysis.
MultiCAFE is written in Java and runs under Icy. It uses extensively the wonderful library designed by Stephane Dallongevile and Fabrice de Chaumont (Institut Pasteur). The code is architectured so that most of the user interface is contained in plugin.fmp.multicafe. Routines dealing with files (reading & writing images, measures, and corresponding classes) are stored within plugins.fmp.multicafeSequence. All other routines meant to analyze data, support specific user interfaces elements, and to export them to excel are store in plugins.fmp.multicafeTools. Lastly, as the creation of kymographs is quite lenghty, this package also include a plugin BuildKymographs in plugins.fmp.multicafeBuildKymos which let the user define a list of experiments (for which the user has already defined capillaries) and create kymographs without supervision (during your coffee / tea break or overnight). 
